<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<title>Sohbet</title>
<script src="https://cdn.socket.io/4.4.1/socket.io.min.js"></script>
<style>
body {
  background-color: black;
  color: #00ff00;
  font-family: monospace;
}
</style>
</head>
<body>
<h3>Hoşgeldin, {{ nickname }} {% if admin %}(Admin){% endif %}</h3>
<div id="chat" style="height:400px; overflow-y:scroll; border:1px solid green; padding:10px;">
    {% for msg in messages %}
        <div>{{ msg }}</div>
    {% endfor %}
</div>
<input id="msg" autocomplete="off" /><button onclick="sendMessage()">Gönder</button>

<script>
const socket = io();

socket.emit('join', {nickname: "{{ nickname }}"});

socket.on('message', data => {
    const chat = document.getElementById('chat');
    const div = document.createElement('div');
    div.textContent = data.msg;
    if (data.admin) div.style.color = "red";
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
});

function sendMessage() {
    const input = document.getElementById('msg');
    if(input.value.trim() === "") return;
    socket.emit('message', {msg: input.value});
    input.value = '';
}
</script>
</body>
</html>

